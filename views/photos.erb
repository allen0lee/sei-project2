<%# all photos in one album with 'upload photo' button%>

<div class="label">album owner: <%= @album_owner %></div> 

<div class="all-photos-container">
    <div class="display-box">

    </div>

    <%# upload photo button should show to album owner, hidden for not album owner %>
    <% if session[:user_id] == @album.user_id  %>
        <div class="upload-photo-form">
            <form action="/photos/<%= @album_id %>/<%= @user_id %>/new">
                <button class="button upload-photo-btn">upload photo</button>
            </form>
        </div>
    <% end %>
</div>


<div class="enlarged-image-container">
    <span class="close-enlarged-image-btn">&times;</span>
    <img id="enlargedImg">
</div>


<script src="https://code.jquery.com/jquery-3.4.1.js"></script>
<script>
    const enlargeImage = (imgs) => {
        var enlargedImageBackground = document.querySelector('.enlarged-image-container');
        var enlargeImg = document.getElementById("enlargedImg");
        enlargedImageBackground.style.display = "block";
        enlargeImg.src = imgs.src;

        var span = document.getElementsByClassName("close-enlarged-image-btn")[0];
        span.onclick = function() { 
            enlargedImageBackground.style.display = "none";
        }
    }


// var showEditDelete = function(event) {
//     event.target.classList.toggle('.show-edit-delete');
// }
// document.querySelectorAll('.photo-name').forEach(function(item) {
//     item.addEventListener('click', showEditDelete);    
// });


  $.ajax({
    url: `/api/photos/<%= @album_name %>/<%= @album_id %>`,
    method: 'get'
  }).done(res => {
    let setDisplayBox = document.querySelector('.display-box')

    for(let i = 0; i < res.length; i++) {
      let div = document.createElement('div')
      setDisplayBox.append(div)

      div.innerHTML = 
      `<div class="photo-display">
        <img src="${res[i].image_url}" alt="" onclick="enlargeImage(this)">
        <div class="photo-name">
          <a href="/photos/${res[i].id}">
            ${res[i].name}
          </a>
        </div>
      </div>`
    }
  })


</script>


